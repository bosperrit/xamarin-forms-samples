variables:
  buildConfiguration: 'Release'
  outputDirectory: '$(build.binariesDirectory)/$(buildConfiguration)'

steps:
- task: NuGetToolInstaller@1

- task: NuGetCommand@2
  inputs:
    restoreSolution: '**/*.sln'

- task: XamarinAndroid@1
  inputs:
    projectFile: '**/*Droid*.csproj'
    outputDirectory: '$(outputDirectory)'
    configuration: '$(buildConfiguration)'
    msbuildVersionOption: '16.0'
jobs:
  - job: build_android_samples
    displayName: Build Android samples
    pool:
      vmImage: 'macos-latest'
    steps:
      - script: sudo $AGENT_HOMEDIRECTORY/scripts/select-xamarin-sdk.sh 5_12_0
        displayName: 'Select the Xamarin SDK version'
        enabled: false
      - task: MSBuild@1
        displayName: Build Android samples
        inputs:
          solution: '**/*Droid*.csproj'
          configuration: 'Debug'
          msbuildArguments: '/restore /t:Build /p:ContinuousIntegrationBuild=true /p:Deterministic=false'
  - job: build_uwp_samples
    displayName: Build UWP samples
    pool:
      vmImage: windows-2019
    steps:
      - task: MSBuild@1
        displayName: Build UWP samples
        inputs:
          solution: '**/*.UWP.csproj'
          configuration: 'Debug'
          msbuildArguments: '/restore /t:Build /p:AppxPackage=false /p:ContinuousIntegrationBuild=true /p:Deterministic=false'    